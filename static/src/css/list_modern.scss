/**
 * Modern List View Theme - Odoo 19
 * Alphaqueb Consulting SAS
 *
 * Sobreescribe globalmente el diseño de todas las vistas de lista
 * sin modificar ningún XML. Estética: refinada, limpia, moderna 2026.
 */

// ─── Variables de diseño ─────────────────────────────────────────────────────
:root {
    --mlv-font-base: 'Geist', 'DM Sans', 'Inter', system-ui, sans-serif;
    --mlv-font-mono: 'Geist Mono', 'JetBrains Mono', monospace;

    // Superficie y fondos
    --mlv-bg-table:         #ffffff;
    --mlv-bg-header:        #f8f8f8;
    --mlv-bg-row:           #ffffff;
    --mlv-bg-row-alt:       #fafafa;
    --mlv-bg-row-hover:     #f4f6fa;
    --mlv-bg-row-selected:  #eef2ff;
    --mlv-bg-row-selected-hover: #e5eaff;

    // Bordes
    --mlv-border-color:     #e8e8ec;
    --mlv-border-header:    #d0d0d8;
    --mlv-border-radius:    10px;

    // Texto
    --mlv-text-header:      #1a1a2e;
    --mlv-text-cell:        #2d2d3a;
    --mlv-text-muted:       #8888a0;
    --mlv-text-link:        #4361ee;
    --mlv-text-link-hover:  #2541c4;

    // Acento / selección
    --mlv-accent:           #4361ee;
    --mlv-accent-soft:      rgba(67, 97, 238, 0.08);

    // Checkbox
    --mlv-check-border:     #c0c0cc;
    --mlv-check-checked-bg: #4361ee;

    // Sombras
    --mlv-shadow-table:     0 1px 3px rgba(0,0,0,.04), 0 4px 16px rgba(0,0,0,.04);
    --mlv-shadow-header:    0 1px 0 var(--mlv-border-color);

    // Transiciones
    --mlv-transition:       150ms ease;

    // Tipografía
    --mlv-header-size:      0.72rem;
    --mlv-cell-size:        0.855rem;
    --mlv-header-weight:    650;
    --mlv-cell-weight:      400;

    // Espaciado
    --mlv-cell-px:          14px;
    --mlv-cell-py:          10px;
    --mlv-header-py:        11px;

    // Row height
    --mlv-row-height:       44px;
}

// ─── Contenedor principal de la vista de lista ───────────────────────────────
.o_list_view {
    background: transparent;
    border: none;
    border-radius: var(--mlv-border-radius);
    overflow: hidden;

    // Sombra sutil en el contenedor de la tabla
    .o_list_renderer,
    > .o_list_renderer {
        background: var(--mlv-bg-table);
        border: 1px solid var(--mlv-border-color);
        border-radius: var(--mlv-border-radius);
        box-shadow: var(--mlv-shadow-table);
        overflow: hidden;
    }
}

// ─── Tabla ───────────────────────────────────────────────────────────────────
.o_list_view table.o_list_table,
.o_list_renderer table.o_list_table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    font-family: var(--mlv-font-base);
    font-size: var(--mlv-cell-size);
    color: var(--mlv-text-cell);
    background: var(--mlv-bg-table);

    // ─── THEAD / Cabeceras ────────────────────────────────────────────────
    thead {
        position: sticky;
        top: 0;
        z-index: 10;
        background: var(--mlv-bg-header);

        tr {
            th {
                background: var(--mlv-bg-header);
                color: var(--mlv-text-header);
                font-size: var(--mlv-header-size);
                font-weight: var(--mlv-header-weight);
                letter-spacing: 0.04em;
                text-transform: uppercase;
                padding: var(--mlv-header-py) var(--mlv-cell-px);
                border-bottom: 1px solid var(--mlv-border-header);
                border-right: none;
                white-space: nowrap;           // ← evita que las cabeceras se corten
                overflow: visible;
                vertical-align: middle;
                cursor: default;
                transition: background var(--mlv-transition), color var(--mlv-transition);
                position: relative;

                // Separador vertical sutil entre columnas
                &:not(:last-child)::after {
                    content: '';
                    position: absolute;
                    right: 0;
                    top: 20%;
                    height: 60%;
                    width: 1px;
                    background: var(--mlv-border-color);
                }

                // Columna ordenable
                &.o_column_sortable {
                    cursor: pointer;

                    .o_list_column_title {
                        display: inline-flex;
                        align-items: center;
                        gap: 5px;
                        transition: color var(--mlv-transition);
                    }

                    &:hover {
                        background: darken(#f8f8f8, 2%);
                        color: var(--mlv-accent);

                        .o_list_column_title {
                            color: var(--mlv-accent);
                        }
                    }

                    // Icono de sort
                    .o_sort_up::before {
                        content: '↑';
                        font-size: 0.7rem;
                        color: var(--mlv-accent);
                        margin-left: 2px;
                    }
                    .o_sort_down::before {
                        content: '↓';
                        font-size: 0.7rem;
                        color: var(--mlv-accent);
                        margin-left: 2px;
                    }
                }

                // Checkbox header
                &.o_list_record_selector,
                &.o_list_selection_box {
                    width: 40px;
                    min-width: 40px;
                    max-width: 40px;
                    text-align: center;
                    padding: var(--mlv-header-py) 8px;
                }

                // Columna de acciones/opcionales
                &.o_list_optional_columns_dropdown {
                    width: 36px;
                    min-width: 36px;
                    text-align: center;
                    padding: var(--mlv-header-py) 8px;
                }

                // Ícono FA en cabeceras
                i.fa {
                    font-size: 0.75rem;
                    color: var(--mlv-text-muted);
                }
            }
        }
    }

    // ─── TBODY / Filas ────────────────────────────────────────────────────
    tbody {
        tr.o_data_row {
            height: var(--mlv-row-height);
            background: var(--mlv-bg-row);
            transition: background var(--mlv-transition);
            border-bottom: 1px solid var(--mlv-border-color);

            &:nth-child(even) {
                background: var(--mlv-bg-row-alt);
            }

            &:last-child {
                border-bottom: none;
            }

            // Hover
            &:not(.o_selected_row):hover {
                background: var(--mlv-bg-row-hover);

                td {
                    color: var(--mlv-text-cell);
                }
            }

            // Fila seleccionada
            &.o_selected_row {
                background: var(--mlv-bg-row-selected);
                box-shadow: inset 3px 0 0 var(--mlv-accent);

                &:hover {
                    background: var(--mlv-bg-row-selected-hover);
                }
            }

            // Fila en edición
            &.o_is_dirty {
                box-shadow: inset 3px 0 0 #f97316;
                background: #fffbf7;
            }

            // Celdas
            td {
                padding: var(--mlv-cell-py) var(--mlv-cell-px);
                border-right: none;
                vertical-align: middle;
                font-size: var(--mlv-cell-size);
                color: var(--mlv-text-cell);
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 0;                  // permite text-overflow en celdas flex

                // Checkbox cel
                &.o_list_record_selector {
                    width: 40px;
                    min-width: 40px;
                    max-width: 40px;
                    text-align: center;
                    padding: var(--mlv-cell-py) 8px;
                }

                // Campo tipo many2one / link
                a, .o_form_uri {
                    color: var(--mlv-text-link);
                    text-decoration: none;
                    font-weight: 500;
                    transition: color var(--mlv-transition);

                    &:hover {
                        color: var(--mlv-text-link-hover);
                        text-decoration: underline;
                    }
                }

                // Badges / etiquetas de estado
                .badge,
                .o_tag {
                    font-size: 0.68rem;
                    font-weight: 600;
                    letter-spacing: 0.03em;
                    padding: 2px 8px;
                    border-radius: 20px;
                    border: none;
                }

                // Campos monetarios / numéricos → alineados derecha
                &.o_monetary_cell,
                &.o_integer_cell,
                &.o_float_cell {
                    text-align: right;
                    font-variant-numeric: tabular-nums;
                    font-family: var(--mlv-font-mono);
                    font-size: 0.83rem;
                }

                // Campos boolean (checkbox)
                .o_field_boolean .o_checkbox,
                .o_field_boolean input[type="checkbox"] {
                    accent-color: var(--mlv-accent);
                    width: 15px;
                    height: 15px;
                    cursor: default;
                }

                // Botones de acción en celdas
                .o_list_record_remove,
                .o_btn_list_action {
                    opacity: 0;
                    transition: opacity var(--mlv-transition);
                }
            }

            &:hover td .o_list_record_remove,
            &:hover td .o_btn_list_action {
                opacity: 1;
            }
        }

        // Fila "New" / agregar registro
        tr.o_list_add_record td {
            padding: 8px var(--mlv-cell-px);
            font-size: var(--mlv-cell-size);
        }

        // Fila vacía / sin registros
        tr.o_list_no_content_helper,
        .o_nocontent_help {
            td {
                padding: 48px var(--mlv-cell-px);
                text-align: center;
                color: var(--mlv-text-muted);
                font-size: 0.9rem;
            }
        }
    }

    // ─── TFOOT / Totales ──────────────────────────────────────────────────
    tfoot {
        tr {
            border-top: 2px solid var(--mlv-border-header);
            background: var(--mlv-bg-header);

            td {
                padding: var(--mlv-cell-py) var(--mlv-cell-px);
                font-weight: 650;
                font-size: var(--mlv-cell-size);
                font-variant-numeric: tabular-nums;
                font-family: var(--mlv-font-mono);
                color: var(--mlv-text-header);
            }
        }
    }
}

// ─── Checkboxes globales ──────────────────────────────────────────────────────
.o_list_view {
    input[type="checkbox"] {
        appearance: none;
        -webkit-appearance: none;
        width: 15px;
        height: 15px;
        border: 1.5px solid var(--mlv-check-border);
        border-radius: 4px;
        background: #fff;
        cursor: pointer;
        transition: all var(--mlv-transition);
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        vertical-align: middle;
        flex-shrink: 0;

        &:checked {
            background: var(--mlv-check-checked-bg);
            border-color: var(--mlv-check-checked-bg);

            &::after {
                content: '';
                display: block;
                width: 9px;
                height: 6px;
                border-left: 2px solid #fff;
                border-bottom: 2px solid #fff;
                transform: rotate(-45deg) translate(1px, -1px);
            }
        }

        &:indeterminate {
            background: var(--mlv-check-checked-bg);
            border-color: var(--mlv-check-checked-bg);

            &::after {
                content: '';
                display: block;
                width: 7px;
                height: 2px;
                background: #fff;
                border-radius: 1px;
            }
        }

        &:hover:not(:checked) {
            border-color: var(--mlv-accent);
            background: var(--mlv-accent-soft);
        }
    }
}

// ─── Botón "Agregar una línea" ────────────────────────────────────────────────
.o_list_view .o_list_add_record a,
.o_list_view a.o_list_add_optional_columns {
    font-size: 0.82rem;
    font-weight: 550;
    color: var(--mlv-accent);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 0;
    transition: opacity var(--mlv-transition);

    &:hover {
        opacity: 0.75;
    }
}

// ─── Toolbar de la lista (búsqueda, botones) ──────────────────────────────────
.o_list_view .o_list_buttons,
.o_control_panel_actions .o_list_buttons {
    .btn {
        border-radius: 7px;
        font-size: 0.83rem;
        font-weight: 550;
        padding: 5px 14px;
        transition: all var(--mlv-transition);

        &.btn-primary {
            background: var(--mlv-accent);
            border-color: var(--mlv-accent);
            color: #fff;

            &:hover {
                background: var(--mlv-text-link-hover);
                border-color: var(--mlv-text-link-hover);
            }
        }

        &.btn-secondary {
            background: #fff;
            border-color: var(--mlv-border-color);
            color: var(--mlv-text-cell);

            &:hover {
                background: var(--mlv-bg-row-hover);
            }
        }
    }
}

// ─── Paginación ───────────────────────────────────────────────────────────────
.o_list_view .o_pager {
    font-size: 0.8rem;
    color: var(--mlv-text-muted);
    font-weight: 500;

    .o_pager_previous,
    .o_pager_next {
        border-radius: 6px;
        border: 1px solid var(--mlv-border-color);
        background: #fff;
        color: var(--mlv-text-cell);
        transition: all var(--mlv-transition);
        padding: 3px 10px;

        &:hover {
            background: var(--mlv-bg-row-hover);
            border-color: var(--mlv-accent);
            color: var(--mlv-accent);
        }
    }

    .o_pager_value {
        font-weight: 600;
        color: var(--mlv-text-cell);
    }
}

// ─── Campo en edición inline ──────────────────────────────────────────────────
.o_list_view .o_selected_row td .o_field_widget input,
.o_list_view .o_selected_row td .o_field_widget textarea,
.o_list_view .o_selected_row td .o_field_widget select {
    border: 1px solid var(--mlv-accent);
    border-radius: 5px;
    padding: 3px 8px;
    font-size: var(--mlv-cell-size);
    font-family: var(--mlv-font-base);
    outline: none;
    box-shadow: 0 0 0 3px var(--mlv-accent-soft);
    background: #fff;
    transition: all var(--mlv-transition);
    width: 100%;
}

// ─── Columnas opcionales dropdown ────────────────────────────────────────────
.o_list_optional_columns_dropdown {
    .o_optional_columns_dropdown_toggle {
        color: var(--mlv-text-muted);
        cursor: pointer;
        transition: color var(--mlv-transition);
        padding: 2px 6px;
        border-radius: 4px;

        &:hover {
            color: var(--mlv-accent);
            background: var(--mlv-accent-soft);
        }
    }
}

// ─── Scrollbar personalizado ──────────────────────────────────────────────────
.o_list_renderer {
    &::-webkit-scrollbar {
        width: 6px;
        height: 6px;
    }

    &::-webkit-scrollbar-track {
        background: transparent;
    }

    &::-webkit-scrollbar-thumb {
        background: #d0d0d8;
        border-radius: 10px;

        &:hover {
            background: #b0b0c0;
        }
    }
}

// ─── Modo oscuro (respeta prefers-color-scheme) ───────────────────────────────
@media (prefers-color-scheme: dark) {
    :root {
        --mlv-bg-table:             #1a1a2a;
        --mlv-bg-header:            #16161f;
        --mlv-bg-row:               #1a1a2a;
        --mlv-bg-row-alt:           #1e1e2e;
        --mlv-bg-row-hover:         #22223a;
        --mlv-bg-row-selected:      #1e2560;
        --mlv-bg-row-selected-hover:#242b70;
        --mlv-border-color:         #2a2a3f;
        --mlv-border-header:        #30304a;
        --mlv-text-header:          #e0e0f0;
        --mlv-text-cell:            #c8c8e0;
        --mlv-text-muted:           #6060a0;
        --mlv-text-link:            #7b9bff;
        --mlv-text-link-hover:      #9db5ff;
        --mlv-check-border:         #4040a0;
    }
}
